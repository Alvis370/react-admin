import React from 'react';
import { Card, Button } from 'antd';
import ReactECharts from 'echarts-for-react';

export default function Pie() {

  const [sales, setSales] = React.useState([5, 20, 36, 10, 10, 20]);
  const [storage, setStorage] = React.useState([15, 25, 46, 30, 22, 25]);

  const update = () => {
    let sa = sales.map(sale => {
      return sale + 1;
    });

    let st = storage.reduce((pre, store) => {
      pre.push(store - 1);
      return pre;
    }, []);

    setSales(sa);
    setStorage(st);
  }

  const getOption = (sales, storage) => {
    return {
      legend: {
        top: 'bottom'
      },
      toolbox: {
        show: true,
        feature: {
          mark: { show: true },
          dataView: { show: true, readOnly: false },
          restore: { show: true },
          saveAsImage: { show: true }
        }
      },
      series: [
        {
          name: 'Nightingale Chart',
          type: 'pie',
          radius: [50, 250],
          center: ['50%', '50%'],
          roseType: 'area',
          itemStyle: {
            borderRadius: 8
          },
          data: [
            { value: 40, name: 'rose 1' },
            { value: 38, name: 'rose 2' },
            { value: 32, name: 'rose 3' },
            { value: 30, name: 'rose 4' },
            { value: 28, name: 'rose 5' },
            { value: 26, name: 'rose 6' },
            { value: 22, name: 'rose 7' },
            { value: 18, name: 'rose 8' }
          ]
        }
      ]
    };
  }

  const getOption2 = (sales, storage) => {
    return {
      backgroundColor: '#2c343c',
      title: {
        text: 'Customized Pie',
        left: 'center',
        top: 20,
        textStyle: {
          color: '#ccc'
        }
      },
      tooltip: {
        trigger: 'item'
      },
      visualMap: {
        show: false,
        min: 80,
        max: 600,
        inRange: {
          colorLightness: [0, 1]
        }
      },
      series: [
        {
          name: 'Access From',
          type: 'pie',
          radius: '55%',
          center: ['50%', '50%'],
          data: [
            { value: 335, name: 'Direct' },
            { value: 310, name: 'Email' },
            { value: 274, name: 'Union Ads' },
            { value: 235, name: 'Video Ads' },
            { value: 400, name: 'Search Engine' }
          ].sort(function (a, b) {
            return a.value - b.value;
          }),
          roseType: 'radius',
          label: {
            color: 'rgba(255, 255, 255, 0.3)'
          },
          labelLine: {
            lineStyle: {
              color: 'rgba(255, 255, 255, 0.3)'
            },
            smooth: 0.2,
            length: 10,
            length2: 20
          },
          itemStyle: {
            color: '#c23531',
            shadowBlur: 200,
            shadowColor: 'rgba(0, 0, 0, 0.5)'
          },
          animationType: 'scale',
          animationEasing: 'elasticOut',
          animationDelay: function (idx) {
            return Math.random() * 200;
          }
        }
      ]
    };
  }

  return (
    <div>
      <Card>
        <Button type='primary' onClick={update}>Update</Button>
      </Card>

      <Card title='Pie chart'>
        <ReactECharts option={getOption(sales, storage)} />

      </Card>

      <Card title='Pie chart 2'>
        <ReactECharts option={getOption2(sales, storage)} />
      </Card>
    </div>
  )
}
